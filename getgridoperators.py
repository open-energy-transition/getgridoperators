names = [
    "International Renewable Energy Agency", "International Energy Agency", "AltaLink", "ATCO", "BC Hydro", "Emera Incorporated", "ENMAX Power Corporation",
    "Hydro One", "Hydro-Qu√©bec", "Manitoba Hydro", "Nalcor Energy", "New Brunswick Power (NB Power)",
    "Nova Scotia Power Incorporated (NSPI)", "SaskPower",
    "Ameren Corporation", "American Electric Power (AEP)", "American Transmission Company (ATC)",
    "Avangrid (Iberdrola USA)", "Bonneville Power Administration (BPA)", "CentrePoint Energy",
    "Consolidated Edison (ConEd)", "Dominion Resource", "Duke Energy", "Entergy Corporation",
    "Eversource Energy (Northeast Utilities earlier)", "Exelon Corporation", "FirstEnergy Corporation",
    "ITC Holdings", "MidAmerican Energy Company", "National Grid USA", "New York Power Authority (NYPA)",
    "NextEra Energy", "NorthWestern Energy", "NV Energy", "Oklahoma Gas and Electric Company (OG&E)",
    "Oncor Electric Delivery", "Pacific Gas and Electric Corporation (PG&E)", "PacifiCorp",
    "PNM Resources", "PPL Corporation", "Public Service Electric & Gas (PSE&G)",
    "Southern California Edison (SCE)", "Southern Company", "Tennessee Valley Authority (TVA)", "Xcel Energy",
    "Compa√±√≠a de Transporte de Energ√≠a El√©ctrica en Alta Tensi√≥n Transener S.A. (Transener)",
    "Empresa Nacional de Electricidad (ENDE)", "ENDE Transmission", "ISA Bolivia S.A. (ISA Bolivia)",
    "EDP Transmiss√£o Goi√°s S.A. (EDP Goi√°s)", "Companhia Hidro El√©trica do S√£o Francisco (Chesf)",
    "Companhia Energetica de Minas Gerais (Cemig)", "Companhia Estadual de Transmiss√£o Energia El√©trica SA (CEEE-T)",
    "Companhia de Transmiss√£o de Energia El√©trica Paulista (CTEEP)", "Copel Gera√ß√£o e Transmiss√£o S.A. (Copel GeT)",
    "Centrais El√©tricas Brasileiras S.A. (Eletrobr√°s)", "Centrais El√©tricas do Norte do Brasil S.A. (Eletronorte)",
    "Companhia de Gera√ß√£o e Transmiss√£o de Energia El√©trica do Sul do Brasil (CGT Eletrosul)",
    "Furnas Centrais El√©tricas S.A. (Furnas)", "State Grid Brazil Holding S.A. (SGBH)",
    "Transmissora Alian√ßa de Energia El√©trica SA (TAESA)",
    "AES Gener S.A.", "ENGIE Energ√≠a Chile S.A", "Transelec S.A.", "Sociedad Austral de Electricidad S.A. (SAESA)",
    "Grupo Energ√≠a Bogot√° (GEB)", "Celsia Colombia S.A. E.S.P",
    "Empresas P√∫blicas de Medell√≠n E.S.P. (EPM)", "Interconexi√≥n El√©ctrica S.A. (ISA)", "Transelca S.A.",
    "Instituto Costarricense de Electricidad (ICE)",
    "TRANSELECTRIC S.A.",
    "Empresa de Transporte y Control de Energ√≠a El√©ctrica (ETCEE)", "Fersa Sociedad An√≥nima (Fersa SA)",
    "Transportadora de Energ√≠a de Centroam√©rica S.A. (TRECSA)", "Transportista El√©ctrica Centroamericana S. A. (TRELEC)",
    "Empresa Nacional de Energ√≠a El√©ctrica (ENEE)",
    "Comisi√≥n Federal de Electricidad (CFE)",
    "Administraci√≥n Nacional de Electricidad (ANDE)",
    "Empresa de Transmisi√≥n El√©ctrica S.A. (ETESA)",
    "Abengoa Peru S.A.", "Consorcio Energ√©tico de Huancavelica S.A. (CONENHUA)",
    "Consorcio Transmantaro S.A. (CTM)", "Etenorte S.R.L.", "Eteselva S.R.L.", "ISA Per√∫ S.A.",
    "Red de Energ√≠a del Per√∫ S.A. (REP SA)", "Red El√©ctrica del Sur S.A. (Redesur)",
    "Administraci√≥n Nacional de Usinas y Trasmisiones El√©ctricas (UTE)",
    "AusNet Services (Transmission) Ltd", "ElectraNet Pty Ltd", "Powerlink Queensland",
    "Tasmanian Networks Pty Ltd (TasNetworks)", "TransGrid", "Western Power",
    "Azerenergy",
    "Electricit√© du Cambodge (EDC)",
    "China Southern Power Grid (CSG)", "State Grid Corporation of China (SGCC)",
    "Gujarat Electricity Transmission Company Limited (GETCO)", "Karnataka Power Transmission Corporation Limited (KPTCL)",
    "Madhya Pradesh Power Transmission Company Limited (MPPTCL)", "Maharashtra State Electricity Transmission Company Limited (MSETCL)",
    "Powergrid Corporation of India Limited (POWERGRID)", "Rajasthan Rajya Vidyut Prasaran Nigam Limited (RVPNL)",
    "Transmission Corporation of Andhra Pradesh Limited (APTransco)", "Transmission Corporation of Telangana Limited (TSTRANSCO)",
    "Tamil Nadu Transmission Corporation Limited (TANTRANSCO)", "Uttar Pradesh Power Transmission Corporation Limited (UPPTCL)",
    "Adani Power Transmission (APL)", "Sterlite Power Transmission Limited (SPTL)",
    "Perusahaan Listrik Negara (PLN)",
    "Chubu Electric Power Grid Company, Inc", "Chugoku Electric Power Company, Inc", "Hokkaido Electric Power Network Company Limited",
    "Hokuriku Electric Power Company, Inc", "J‚ÄêPOWER (Electric Power Development Company Limited)", "Kansai Electric Power Company, Inc",
    "Kyushu Electric Power Company, Inc", "Okinawa Electric Power Company, Inc", "Shikoku Electric Power Company, Inc",
    "Tohoku Electric Power Network Company, Inc", "TEPCO Power Grid, Inc",
    "Kazakhstan Electricity Grid Operating Company (KEGOC)",
    "Electricite du Laos (EDL)",
    "Sabah Electricity SdnBhd (SESB)", "Syarikat SESCO Berhad (SESCO)", "Tenaga Nasional Berhad (TNB)",
    "Nepal Electricity Authority (NEA)",
    "K-Electric", "National Transmission and Despatch Company (NTDC)",
    "National Grid Corporation of the Philippines (NGCP)",
    "Singapore Power (SP)",
    "Korea Electric Power Corporation (KEPCO)",
    "Electricity Generating Authority of Thailand (EGAT)",
    "Uzbekenergo",
    "EVN National Power Transmission Corporation (EVN NPT)",
    "Austrian Power Grid AG (APG)", "TINETZ-TirolerNetze GmbH", "Vorarlberg √úbertragungsnetz GmbH (V√úN)",
    "Elia System Operator SA (Elia)",
    "Independent System Operator in Bosnia and Herzegovina (ISO B&H)",
    "Electricity System Operator (ESO)",
    "Hrvatskog operatora prijenosnog sustava d.o.o. (HOPS)",
    "ƒåEPS A.S.",
    "Energinet.dk",
    "Elering O√ú",
    "FingridOyj",
    "Reseau de Transport d'Electricite (RTE)",
    "Georgia State Electrosystem JSC (GSE)",
    "50Hertz Transmission GmbH (50Hertz)", "Amprion GmbH", "TenneT TSO GmbH", "TransnetBW GmbH",
    "Anexartitos Diacheiristis Metaforas Ilektrikis Energeias A.E. (ADMIE)",
    "MAVIR ZRt.",
    "Landsnet HF",
    "EirGrid Plc",
    "Terna S.p.A",
    "Augstsprieguma TiÃÑkls AS (AST)",
    "Litgrid AB",
    "Makedonski Elektro Prenosen Sistem Operator A.D. (MEPSO)",
    "Crnogorski Elektroprenosni Sistem A.D. (CGES)",
    "TenneT TSO B.V.",
    "Statnett SF",
    "Polskie Sieci Elektroenergetyczne S.A. (PSE)",
    "Rede El√©ctrica Nacional (REN)",
    "Rede El√©ctrica Nacional SA (REN)", "Red El√©ctrica de Espa√±a S.A. (REE)",
    "Transelectrica S.A.",
    "Elektromre≈æa Srbije (EMS)",
    "Slovenska Elektrizacna Prenosova Sustava AS (SEPS)",
    "ELES d.o.o",
    "Svenska Kraftn√§t",
    "Swissgrid AG",
    "T√ºrkiye ElektrikIletim A.≈û. (TEIAS)",
    "National Grid Electricity Transmission Plc (NGET)", "Scottish Hydro Electric Transmission Limited (SHETL)", "Scottish Power Transmission Plc (SPT)",
    "Electricity and Water Authority (EWA)",
    "National Electric Power Company (NEPCO)",
    "Ministry of Electricity and Water (MEW)",
    "Oman Electricity Transmission Company (OETC)",
    "Qatar General Electricity & Water Corporation (KAHRAMAA)",
    "Saudi Electricity Company (SEC)",
    "Dubai Electricity and Water Authority (DEWA)", "Abu Dhabi Transmission and Despatch Company (TRANSCO)",
    "Soci√©t√© Alg√©rienne de Gestion du R√©seau de Transport de l‚ÄôElectricit√© (GTRE)",
    "Rede Nacional de Transporte de Electricidade (RNT)",
    "Botswana Power Corporation (BPC)",
    "SONATREL",
    "Egyptian Electricity Transmission Company (EETC)",
    "Ethiopian Electric Power Corporation (EEPCo)",
    "Ghana Grid Company Limited (GRIDCo)", "Transpower",
    "Compangie Ivoirienne d‚ÄôElectricit√© (CIE)",
    "Kenya Power", "Kenya Electricity Transmission Company Limited (KETRACO)",
    "L‚ÄôOffice National d‚ÄôElectricit√© et de l‚ÄôEau Potable (ONEE)",
    "Electricidade de Mo√ßambique (EDM)",
    "Namibia Power Corporation (Proprietary) Limited (NamPower)",
    "Transmission Company of Nigeria (TCN)",
    "Rwanda Energy Group Limited (REG)",
    "Eskom Holdings SOC Limited (Eskom)",
    "Tanzania Electric Supply Company (TANESCO)",
    "Soci√©t√© Tunisienne de l‚ÄôElectricit√© et du Gaz (STEG)",
    "Uganda Electricity Transmission Company Limited (UETCL)",
    "ZESCO Limited",
    # New names
    "OST sh.a", "Austrian Power Grid AG", "Vorarlberger √úbertragungsnetz GmbH", "NOS BiH",
    "Elia System Operator SA", "Electroenergien Sistemen Operator EAD", "Swissgrid ag",
    "Cyprus Transmission System Operator", "ƒåEPS a.s.", "TransnetBW GmbH",
    "TenneT TSO GmbH", "Amprion GmbH", "50Hertz Transmission GmbH", "Energinet",
    "Elering AS", "Red El√©ctrica de Espa√±a S.A.", "Fingrid Oyj", "R√©seau de Transport d'Electricit√©",
    "Independent Power Transmission Operator S.A.", "HOPS d.d.", "MAVIR", "EirGrid plc",
    "Landsnet hf", "Terna - Rete Elettrica Nazionale SpA", "Litgrid AB", "Creos Luxembourg S.A.",
    "AS Augstsprieguma tƒ´kls", "Crnogorski Elektroprenosni Sistem AD", "System Operator for Northern Ireland Ltd",
    "TenneT TSO B.V.", "Statnett SF", "Transmission System Operator of the Republic of North Macedonia",
    "Polskie Sieci Elektroenergetyczne S.A.", "Rede El√©ctrica Nacional, S.A.", "C.N. Transelectrica S.A.",
    "Akcionarsko dru≈°tvo Elektromre≈æa Srbije", "Svenska Kraftn√§t", "ELES, d.o.o.", 
    "Slovensk√° elektrizaƒçn√° prenosov√° s√∫stava, a.s.", "National Power Company Ukrenergo",
    "Moldelectrica", "Turkish Electricity Transmission Corporation",
    "Codensa S.A. E.S.P",
    "Alupar Investimento S.A.",
    "Empresa de √Ågua E Electricidade",
    "Dabs Da Afghanistan Breshna Sherkat",
    "Nampower",
    "Empresas P√∫blicas de Medell√≠n E.S.P.",
    "Operatori I Sistemit Te Transmetimit",
    "Volta River Authority",
    "Kenya Power and Lighting Company",
    "Ena - Electric Networks of Armenia Cjsc",
    "Electricidade E Alguas de Guine-Bissa",
    "Electricity Company of Ghana",
    "Electricity Supply Corporation of Malawi",
    "Botswana Power Corporation",
    "Northern Regions Electricity Distributor",
    "Irbid District Electricity Distribution Company",
    "Kharkivoblenergo Jsc",
    "Central Electricity Board",
    "Powergrid Corporation of India",
    "Umeme Limited",
    "Soci√©t√© Nationale D'√âlectricit√© Du S√©n√©gal",
    "National Electric Power Company",
    "Enel Colombia",
    "Centrales El√©ctricas de Nari√±o S.A. E.S.P.",
    "Soci√©t√© Nationale D'Electricit√©",
    "Turkiye Elektrik Iletim Anonim Sirketi",
    "Zambia Electricity Supply Corporation",
    "Tunisian Company of Electricity and Gas",
    "Societatea Energetica Electrica Sa - Consolidated",
    "Peshwar Electric Supply Company Limited",
    "Hyderabad Electric Supply Company",
    "Vietnam Electricity",
    "Energy Utility Corporation Limited",
    "Empresa Regional de Servicio P√∫blico de Electricidad Del Centro S.A.",
    "Ikeja Electricity Distribution Company",
    "Quetta Electric Supply Company Limited",
    "Empresa de Luz Y Fuerza El√©ctrica Cochabamba S.A.",
    "National Power Company \"Ukrenergo\"",
    "Moldelectrica",
    "Operatori I Shperndarjes Se Energjise Elektrike Sha",
    "Pohnpei Utilities Corporation",
    "Regional Electricity Networks (Ukraine)",
    "Electricity Distribution Company",
    "Electricity Distribution and Supply Authority",
    "Lyonnaise des Eaux de Casablanca",
    "Transelec S.A.",
    "Georgian State Electrosystem Jsc",
    "Lesotho Electricity Company",
    "Kenya Electricity Transmission Co.",
    "Hrvatska Elektroprivreda",
    "Kano Electricity Distribution Company",
    "Cntee Transelectrica Sa",
    "Kazakhstan Electricity Grid Operating Company",
    "Tubas Electricity Distribution Company",
    "Yola Electricity Distribution Company",
    "Copperbelt Energy Corporation",
    "Empresa P√∫blica de Produ√ß√£o de Electricidade",
    "Empresa Distribuidora Y Comercializadora Norte S.A.",
    "Compa√±√≠a de Transporte de Energ√≠a El√©ctrica En Alta Tensi√≥n Transener S.A.",
    "Sudanese Electricity Transmission Company",
    "Empresa de Electricidade E √Äqua",
    "Port Harcourt Electricity Distribution Company",
    "Bangladesh Power Development Board",
    "Sukkur Electric Power Company",
    "Compa√±√≠a El√©ctrica Sucre S.A.",
    "Eswatini Electricity Company",
    "Electric Power Company of Togo",
    "Adani Electricity Mumbai Limited",
    "Jp Elektroprivreda Bih Dd Sarajevo",
    "Bangalore Electricity Supply Company Limited",
    "Empresa Provincial de Energ√≠a de C√≥rdoba",
    "National Power Corporation",
    "Empresa Nacional de Distribu√ß√£o de Electricidade",
    "Soci√©t√© B√©ninoise D'Energie Electrique",
    "Energie Du Mali",
    "Empresa Distribuidora de Electricidad de Mendoza S.A.",
    "Eneo Cameroun S.A.",
    "Caribemar de la Costa S.A.S. E.S.P",
    "Metropolitan Electricity Authority",
    "Jodhpur Vidyut Vitran Nigam Limited",
    "Kazakhstan Utility Systems",
    "Provincial Electricity Authority",
    "Transmissora Alian√ßa de Energia El√©trica S.A.",
    "High Voltage Electrical Networks Cjsc",
    "Pjsc Dtek Kyiv Regional Electric Networks",
    "Astana Regional Distribution",
    "Distribution System Operator",
    "Electric Power Industry of Serbia",
    "Purvanchal Vidyut Vitran Nigam Limited",
    "Ghana Grid Company",
    "Tanzania Electric Supply Company",
    "Dhaka Power Distribution Company",
    "National Electric Grid of Kyrgyzstan",
    "Soci√©t√© des Energies de Cote D'Ivoire",
    "Energy Fiji Limited",
    "Alatau Jariq",
    "Ethiopian Electric Power",
    "Transmission, System and Market Operator - Kostt J.S.C.",
    "Uganda Electricity Generation Company",
    "Liberia Electricity Corporation",
    "Faisalabad Electric Supply Company Limited",
    "Saudi Electricity Company",
    "Tenaga Nasional Berhad",
    "Toshkent Shahar Elektr Tarmoqlari Korxonasi",
    "Empresa El√©ctrica P√∫blica Estrat√©gica Corporaci√≥n Nacional de Electricidad",
    "Dakshin Gujarat Vij Company Limited",
    "Intercolombia S.A. E.S.P",
    "Soci√©t√© Nig√©rienne D'Electricit√©",
    "Marshalls Energy Company",
    "Uganda Electricity Transmission Company",
    "Jerusalem District Electricity Company",
    "Energia de Entre Rios Sociedad Anonima",
    "Dominica Electricity Services Limited",
    "Zimbabwe Electricity Transmission and Distribution Company",
    "Abuja Electricity Distribution Company",
    "Gambia Water & Electricity Company",
    "Nepal Electricity Authority",
    "Oman Electricity Transmission Company",
    "Power Grid Company of Bangladesh Ltd.",
    "Compagnie Ivoirienne D'Electricit√©",
    "Sudanese Thermal Power Generating Company",
    "Islamabad Electric Supply Company",
    "West Bengal State Electricity Distribution Company Limited",
    "Madhya Pradesh Madhya Kshetra Vityut Vitran Company Limited",
    "West Zone Power Distributions Company Limited",
    "Azerenerji",
    "Solomon Islands Electricity Authority",
    "Lahore Electric Supply Company Limited",
    "R√©gie de Production et de Distribution D'Eau et D'Electricit√©",
    "Soci√©t√© Mauritanienne D'√âlectricit√©",
    "Tata Power Delhi Distribution Limited",
    "Erongo Regional Electricity Distributor",
    "Companhia de Transmiss√£o de Energia El√©trica Paulista S.A",
    "Soci√©t√© Nationale de L‚ÄôElectricit√© des Comores",
    "St. Lucia Electricity Services Limited",
    "Kanpur Electricity Supply Company Limited",
    "Soci√©t√© Nationale D'Electricit√©",
    "Multan Electric Power Company Limited",
    "Central North Regional Electricity Distributor",
    "Elektroprivreda Crne Gore Ad Niksic",
    "Jos Electricity Distribution",
    "Electricity Generating Authority of Thailand",
    "Severelectro (Kyrgyz Republic)",
    "Empresa de Energ√≠a Del Quind√≠o S.A. E.S.P.",
    "K-Electric Limited",
    "Perusahaan Perseroan (Persero) Pt Perusahaan Listrik Negara",
    "Distribuidora de Electricidad de la Paz S.A.",
    "Regional Electrical Power Networks",
    "Ethiopian Electric Utility",
    "Administraci√≥n Nacional de Electricidad",
    "Eko Electricity Distribution Company",
    "Soci√©t√© Nationale D'√âlectricit√© Du Burkina Faso",
    "Png Power Limited",
    "Northern Electricity Distribution Company",
    "Electricidade de Mo√ßambique",
    "Transmission Company of Nigeria",
    "Administraci√≥n Nacional de Usinas Y Trasmisiones El√©ctricas",
    "Ibadan Electricity Distribution Company",
    "Soceite D'Energie et D'Eau Du Gabon",
    "Azerishig",
    "Enel Distribuci√≥n Per√∫ S.A.A.",
    "A Empresa El√©ctrica Regional Centro Sur C.A.",
    "Sudanese Electricity Distribution Company",
    "Jiro Sy Rano Malagasy",
    "Kaduna Electricity Distribution Company",
    "Kenya Electricity Generation Company",
    "Andhra Pradesh Eastern Power Distribution Company Limited",
    "Jordan Electric Power Company",
    "Dakshin Haryana Bijli Vitran Nigam Limited",
    "Pamir Energy Company",
    "National Transmission & Despatch Company",
    "Southern Electric Company",
    "Benin Electricity Distribution Company",
    "Empresa Rede Nacional de Transporte de Electricidade",
    "Zimbabwe Power Company",
    "R√©gie Autonome de Distribution D'Eau et D'Electricit√© de Marrakech",
    "Maharashtra State Electricty Distribution Company Limited",
    "Enugu Electricity Distribution Company",
    "Eskom Holdings Soc Ltd",
    "National Electric Grid of Uzbekistan",
    "Akmola Electricity Distribution Company",
    "Gurjanwala Electric Power Company Limited",
    "Comision Federal de Electricidad",
    "Energie Centrafricaine",
    "Barqi Tojik",
    "Electrificadora de Santander S.A. E.S.P",
    "Sudanese Hydro and Renewable Energy Generation Company",
    "Companhia Paulista de For√ßa Luz",
    "Electricit√© de Guin√©e",
    "Empresa Provincial de la Energ√≠a de Santa F√©"
    "National Grid Electricity System Operator [NGESO]",
    "Federal Energy Regulatory Commission [FERC]",
    "Energinet [Energinet]",
    "Bundesnetzagentur [BNetzA]",
    "Austrian Power Grid [APG]",
    "Elia [Elia]",
    "Creos Luxembourg S.A. [Creos]",
    "ƒåEPS [ƒåEPS]",
    "TransnetBW [TransnetBW]",
    "TenneT [TenneT]",
    "Amprion [Amprion]",
    "50Hertz [50Hertz]",
    "Elering [Elering]",
    "Red El√©ctrica de Espa√±a [REE]",
    "Fingrid [Fingrid]",
    "R√©seau de Transport d‚ÄôElectricit√© [RTE]",
    "Independent Power Transmission Operator [IPTO]",
    "HOPS [HOPS]",
    "MAVIR [MAVIR]",
    "EirGrid [EirGrid]",
    "Landsnet [Landsnet]",
    "Terna [Terna]",
    "Litgrid [Litgrid]",
    "Augstsprieguma tƒ´kls [AST]",
    "Electric System Operator [ESO]",
    "Swissgrid [Swissgrid]",
    "Crnogorski Elektroprenosni Sistem [CGES]",
    "MEPSO [MEPSO]",
    "Polskie Sieci Elektroenergetyczne [PSE]",
    "Rede El√©ctrica Nacional [REN]",
    "Transelectrica [Transelectrica]",
    "Elektromre≈æa Srbije [EMS]",
    "Svenska kraftn√§t [Svenska kraftn√§t]",
    "ELES [ELES]",
    "SEPS [SEPS]",
    "Ukrenergo [Ukrenergo]",
    "Operatori i Sistemit t√´ Transmetimit [OST]",
    "NOSBiH [NOSBiH]",
    "Transmission System Operator Cyprus [TSOC]",
    "Power Grid Corporation of India [PGCIL]",
    "State Grid Corporation of China [SGCC]",
    "China Southern Power Grid [CSG]",
    "Transtel (former EMS) [TESA]",
    "CELEC EP [CELEC EP]",
    "Moldelectrica [Moldelectrica]",
    "TEƒ∞A≈û [TEƒ∞A≈û]",
    "PJM Interconnection [PJM]",
    "Midcontinent ISO [MISO]",
    "California ISO [CAISO]",
    "NYISO [NYISO]",
    "ISO New England [ISO-NE]",
    "Southwest Power Pool [SPP]",
    "Electric Reliability Council of Texas [ERCOT]",
    "Independent Electricity System Operator [IESO]",
    "ENMAX [ENMAX]",
    "Canadian Electricity Association [CEA]",
    "National Energy Board [NEB]",
    "Ofgem [Ofgem]",
    "Commission for Energy Regulation [CER]",
    "Commission de R√©gulation de l'√ânergie [CRE]",
    "ARERA [ARERA]",
    "E-Control [E-Control]",
    "Central Securities Regulator [CSRC]",
    "Saudi Electricity Company [SEC]",
    "National Energy Regulator of South Africa [NERSA]",
    "EgyptERA [EgyptERA]",
    "Kenya Energy and Petroleum Regulator [EPRA]",
    "Botswana Energy Regulatory Authority [BERA]",
    "Malawi Energy Regulatory Authority [MERA]",
    "Zimbabwe Energy Regulatory Authority [ZERA]",
    "Ofwat [Ofwat]"

    # Africa
    "Botswana Energy Regulatory Authority (BERA)",
    "Egyptian Electric Utility and Consumer Protection Regulatory Agency",
    "Malawi Energy Regulatory Authority (MERA)",
    "Energy and Petroleum Regulatory Authority (EPRA)",
    "National Energy Regulator (NERSA)",
    "Zimbabwe Energy Regulatory Authority (ZERA)",
    "Fair Trading Commission (FTC)",  # Barbados

    # Americas
    "Canada Energy Regulator (CER)",
    "Canadian Nuclear Safety Commission (CNSC)",
    "Federal Energy Regulatory Commission (FERC)",
    "Nuclear Regulatory Commission (NRC)",  # USA

    # Asia - South Asia & Others
    "Bangladesh Energy Regulatory Commission (BERC)",
    "Bhutan Electricity Authority (BEA)",
    "Central Electricity Regulatory Commission (CERC)",  # India
    "Atomic Energy Regulatory Board (AERB)",  # India - nuclear
    "Energy Commission of Malaysia (Suruhanjaya Tenaga)",
    "Electricity Regulatory Commission (ERC)",  # Nepal
    "Authority for Electricity Regulation (AER)",  # Oman
    "Oil & Gas Regulatory Authority (OGRA)",  # Pakistan
    "National Electric Power Regulatory Authority (NEPRA)",  # Pakistan
    "Pakistan Nuclear Regulatory Authority (PNRA)",  # Pakistan
    "State Electricity Regulatory Commission (SERC)",  # China
    "China Atomic Energy Authority (CAEA)",  # China - nuclear
    "Energy Regulatory Commission (ERC)",  # Philippines
    "Energy Market Authority (EMA)",  # Singapore
    "Public Utilities Commission of Sri Lanka (PUCSL)",
    "Energy Regulatory Commission (ERC)",  # Thailand

    # ERRA members (Europe & Eurasia)
    "Energy Regulatory Authority",  # Albania
    "Public Services Regulatory Commission of Armenia",
    "Tariff (Price) Council of the Republic of Azerbaijan",
    "Azerbaijan Energy Regulatory Agency",
    "State Electricity Regulatory Commission",  # Bosnia & Herzegovina
    "State Energy and Water Regulatory Commission",  # Bulgaria
    "Croatian Energy Regulatory Agency",
    "Energy Regulatory Division of the Estonian Competition Authority",
    "Georgian National Energy and Water Supply Regulatory Commission",
    "Hungarian Energy Office",
    "Agency of the Republic of Kazakhstan for Regulation of Natural Monopolies",
    "State Department of Fuel & Energy Regulation, Energy and Fuel Resources of Kyrgyz Republic",
    "Public Utilities Commission",  # Latvia
    "National Control Commission for Prices and Energy in Lithuania",
    "Energy Regulatory Commission of the Republic of Macedonia",
    "National Energy Regulatory Agency",  # Moldova
    "Energy Regulatory Authority",  # Mongolia
    "Energy Regulatory Agency of the Republic Montenegro",
    "Energy Regulatory Office",  # Poland
    "Romanian Energy Regulatory Authority",
    "Federal Tariff Service",  # Russia
    "Energy Agency of the Republic of Serbia",
    "Regulatory Office for Network Industries",  # Slovakia
    "Energy Market Regulatory Authority",  # Turkey
    "National Electricity Regulatory Commission of Ukraine",

    # Associate & Affiliated members
    "National Regulatory Authority for Municipal Services",  # Romania
    "Energy Regulatory Office of UNMIK Kosovo",
    "Electricity Regulatory Commission",  # Jordan
    "Nigerian Electricity Regulatory Commission",
    "Water and Electricity Regulatory Authority - WERA",  # Saudi Arabia
    "Regulation and Supervision Bureau of United Arab Emirates",
    "National Association of Regulatory Utility Commissioners - NARUC",  # US

    # East Africa
    "Energy and Petroleum Regulatory Authority",  # Kenya
    "Energy and Water Utilities Regulatory Authority",  # Tanzania
    "Zanzibar Utilities Regulatory Authority",
    "Electricity Regulatory Authority",  # Uganda
    "Petroleum Authority of Uganda",
    "Rwanda Utilities Regulatory Authority",
    "Autorit√© de R√©gulation des secteurs de l‚ÄôEau potable et de l‚ÄôEnergie",  # Burundi
    "Petroleum Upstream Regulatory Authority",  # Tanzania
    "L‚ÄôAutorit√© de R√©gulation du secteur de l‚ÄôElectricit√©",  # DRC

    "Power Grid Corporation of India Limited",           # Central Transmission Utility (inter-state) :contentReference[oaicite:1]{index=1}
    "Grid Controller of India Limited",                  # National grid operator (formerly POSOCO) :contentReference[oaicite:2]{index=2}
    "Andhra Pradesh Transmission Corporation Limited",   # State Transmission Utility :contentReference[oaicite:3]{index=3}
    "Assam Electricity Grid Corporation Limited",        # State Transmission Utility :contentReference[oaicite:4]{index=4}
    "Bihar State Power Transmission Company Limited",    # State Transmission Utility :contentReference[oaicite:5]{index=5}
    "Chhattisgarh State Power Transmission Company Ltd", # State Transmission Utility :contentReference[oaicite:6]{index=6}
    "Delhi Transco Limited",                             # State Transmission Utility :contentReference[oaicite:7]{index=7}
    "Gujarat Energy Transmission Corporation Limited",   # State Transmission Utility :contentReference[oaicite:8]{index=8}
    "Haryana Vidyut Prasaran Nigam Limited",             # State Transmission Utility :contentReference[oaicite:9]{index=9}
    "Karnataka Power Transmission Corporation Ltd",      # State Transmission Utility :contentReference[oaicite:10]{index=10}
    "Madhya Pradesh Power Transmission Company Ltd",     # State Transmission Utility :contentReference[oaicite:11]{index=11}
    "Maharashtra State Electricity Transmission Co Ltd", # State Transmission Utility :contentReference[oaicite:12]{index=12}
    "Punjab State Transmission Corporation Ltd",         # State Transmission Utility :contentReference[oaicite:13]{index=13}
    "Rajasthan Rajya Vidyut Prasaran Nigam Ltd",         # State Transmission Utility :contentReference[oaicite:14]{index=14}
    "Tamil Nadu Transmission Corporation Limited",       # State Transmission Utility :contentReference[oaicite:15]{index=15}
    "Uttar Pradesh Power Transmission Corporation Ltd",  # State Transmission Utility :contentReference[oaicite:16]{index=16}
    "West Bengal State Electricity Transmission Co Ltd"   # State Transmission Utility :contentReference[oaicite:17]{index=17}
    "National Transmission and Despatch Company (NTDC)",
    "Khyber Pakhtunkhwa Transmission & Grid System Company (Private) Limited",
    "Punjab Grid Company Limited",
    "Sindh Transmission & Dispatch Company (Pvt.) Limited",
    "K-Electric Limited",
    "Fatima Transmission Company Limited",
    "Pak Matiari-Lahore Transmission Line Company"
    "PT Perusahaan Listrik Negara (PLN)",
    "Tenaga Nasional Berhad (TNB)",
    "Sabah Electricity Sdn. Bhd. (SESB)",
    "National Grid Corporation of the Philippines (NGCP)",
    "Electricity Generating Authority of Thailand (EGAT)",
    "EVN National Power Transmission Corporation (EVN NPT)",
    "SP Group (Singapore Power)",
    "Electricit√© du Laos (EDL)",
    "Electricite de Cambodge (EDC)",
    "Myanmar Electricity Transmission/Distribution",
    "Brunei Electricity Grid"
    "Transener S.A.",        # Main national extra‚Äëhigh‚Äëvoltage transmission operator :contentReference[oaicite:1]{index=1}
    "Transba S.A.",          # Operates trunk transmission network in Buenos Aires province :contentReference[oaicite:2]{index=2}
    "LITSA",                 # L√≠neas de Transmisi√≥n del Litoral S.A. :contentReference[oaicite:3]{index=3}
    "Transnoa",              # Regional transmission operator (Northwest) :contentReference[oaicite:4]{index=4}
    "Transnea",              # Regional transmission operator (Northeast) :contentReference[oaicite:5]{index=5}
    "Transpa",               # Regional transmission operator (Pampeana) :contentReference[oaicite:6]{index=6}
    "Distrocuyo"             # Regional transmission operator (Cuyo) :contentReference[oaicite:7]{index=7}
    "Centrais El√©tricas Brasileiras S.A. (Eletrobras)",
    "Centrais El√©tricas do Norte do Brasil S.A. (Eletronorte)",
    "CGT Eletrosul ‚Äì Companhia de Gera√ß√£o e Transmiss√£o de Energia El√©trica do Sul do Brasil ‚Äì Eletrobras CGT Eletrosul",
    "Furnas ‚Äì Centrais El√©tricas S.A. (Eletrobras Furnas)",
    "Companhia de Transmiss√£o de Energia El√©trica Paulista (ISA CTEEP)",
    "Transmissora Alian√ßa de Energia El√©trica S.A. (TAESA)",
    "Companhia Energ√©tica de Minas Gerais Gera√ß√£o e Transmiss√£o S.A. (CEMIG G&T)",
    "Copel Gera√ß√£o e Transmiss√£o S.A.",
    "Companhia Estadual de Gera√ß√£o e Transmiss√£o ‚Äì CEEE Gera√ß√£o e Transmiss√£o",
    "CELG Gera√ß√£o e Transmiss√£o S.A. (CELG GT)",
    "Neoenergia Transmiss√£o (various SPEs of Neoenergia S.A.)",
    "State Grid Brazil Holding S.A.",
    "Alupar Investimento S.A.",
    "Argo Energia Empreendimentos e Participa√ß√µes S.A.",
    "Auren Energia S.A.",
    "EDF Norte Fluminense S.A.",
    "EDP Energias do Brasil S.A.",
    "Engie Brasil Energia S.A.",
    "Equatorial Energia S.A.",
    "Grupo CPFL Energia (transmission subsidiaries)",
    "L.I.G. Global Service Tecnologia em Implanta√ß√£o Sistemas Telecomunica√ß√µes e Energia Ltda",
    "Cymi Constru√ß√µes e Participa√ß√µes S.A.",
    # Colombia
    "ISA Intercolombia",         # Part of Interconexi√≥n El√©ctrica S.A. operations in Colombia :contentReference[oaicite:0]{index=0}
    "ISA Transelca",             # Another ISA affiliate in Colombia :contentReference[oaicite:1]{index=1}
    "XM (Operador del Sistema)",# Market/coordination operator in Colombia :contentReference[oaicite:2]{index=2}

    # Chile
    "ISA Energ√≠a (Chile)",      # ISA affiliate operating transmission assets in Chile :contentReference[oaicite:3]{index=3}
    "Interconexiones del Norte",# Chile transmission company under ISA Energ√≠a :contentReference[oaicite:4]{index=4}
    "Conexi√≥n Energ√≠a",         # Another Chile transmission concession under ISA Energ√≠a :contentReference[oaicite:5]{index=5}
    "Transemel",                # Independent transmission operator in Chile :contentReference[oaicite:6]{index=6}
    "Transmisora Sur",          # Smaller Chilean transmission operator :contentReference[oaicite:7]{index=7}
    "Red El√©ctrica Chile / TEN / REDENOR / Centinela Transmisi√≥n",  # Group of transmission concessions managed by Red El√©ctrica/affiliates in Chile :contentReference[oaicite:8]{index=8}

    # Peru
    "ISA Energ√≠a (Per√∫)",      # ISA affiliate in Peru involved in transmission :contentReference[oaicite:9]{index=9}
    "Red de Energ√≠a del Per√∫",  # Major Peruvian transmission system operator :contentReference[oaicite:10]{index=10}
    "Consorcio Transmantaro",   # Transmission concession in Peru :contentReference[oaicite:11]{index=11}
    "Consorcio El√©ctrico Yapay",# Transmission concession in Peru :contentReference[oaicite:12]{index=12}
    # Also note: Spanish company Celeo Redes won a Peru‚ÄìEcuador interconnection concession (transmission project) :contentReference[oaicite:13]{index=13}
    "Celeo Redes",              # Transmission concessions (incl. Peru‚ÄìEcuador link) :contentReference[oaicite:14]{index=14}
    "Red El√©ctrica Andina / REDESUR / REDELNOR",  # Transmission companies in Peru under the Red El√©ctrica group :contentReference[oaicite:15]{index=15}

    # Bolivia
    "ISA Bolivia",             # ISA affiliate operating transmission assets in Bolivia :contentReference[oaicite:16]{index=16}
    # (Note: Bolivia‚Äôs transmission sector also includes state and concessionaires regulated by government, but ISA Bolivia is a prominent operator.)

    # Ecuador
    "Celeo Redes (Ecuador)",     # Project operator for the Peru‚ÄìEcuador interconnection (concession) :contentReference[oaicite:17]{index=17}
    # The national Ecuadorean grid operator is typically managed via state system operator (e.g., CENACE Ecuador), though major concessionaires also participate.
    "Soci√©t√© Alg√©rienne de Gestion du R√©seau de Transport de l‚Äô√âlectricit√© (GRTE)",  # Algeria :contentReference[oaicite:0]{index=0}
    "Egyptian Electricity Transmission Company (EETC)",                            # Egypt :contentReference[oaicite:1]{index=1}
    "General Electricity Company of Libya (GECOL)",                               # Libya :contentReference[oaicite:2]{index=2}
    "Office National de l‚Äô√âlectricit√© et de l‚ÄôEau Potable (ONEE)",               # Morocco :contentReference[oaicite:3]{index=3}
    "Soci√©t√© Tunisienne de l‚Äô√âlectricit√© et du Gaz (STEG)"                        # Tunisia :contentReference[oaicite:4]{index=4}
    "Empresa Rede Nacional de Transporte de Electricidade (RNT‚ÄëEP)",   # Angola :contentReference[oaicite:0]{index=0}
    "REGIDESO Burundi",                                              # Burundi :contentReference[oaicite:1]{index=1}
    "SONATREL (Soci√©t√© Nationale de Transport de l‚Äô√âlectricit√©)",    # Cameroon :contentReference[oaicite:2]{index=2}
    "SNE (Soci√©t√© Nationale d‚ÄôElectricit√©)",                          # Chad :contentReference[oaicite:3]{index=3}
    "Energia Centrafricaine (ENERCA)",                                # Central African Republic :contentReference[oaicite:4]{index=4}
    "Soci√©t√© Nationale d‚Äô√âlectricit√© (SNEL)",                         # Democratic Republic of the Congo :contentReference[oaicite:5]{index=5}
    "SNE (Soci√©t√© Nationale d‚ÄôElectricit√©)",                          # Republic of the Congo :contentReference[oaicite:6]{index=6}
    "SEEG (Soci√©t√© d‚ÄôEnergie et d‚ÄôEau du Gabon)",                     # Gabon :contentReference[oaicite:7]{index=7}
    "SEGESA (Sociedad de Electricidad de Guinea Ecuatorial)",         # Equatorial Guinea :contentReference[oaicite:8]{index=8}
    "EMAE (Empresa de √Ågua e Electricidade)"                          # S√£o Tom√© and Pr√≠ncipe :contentReference[oaicite:9]{index=9}
    "Transmission Company of Nigeria (TCN)",            # Nigeria national grid operator :contentReference[oaicite:0]{index=0}
    "Ghana Grid Company (GRIDCo)",                     # Ghana‚Äôs transmission system operator :contentReference[oaicite:1]{index=1}
    "Soci√©t√© Nig√©rienne d'√âlectricit√© (NIGELEC)",       # Niger national utility with transmission roles :contentReference[oaicite:2]{index=2}
    "Soci√©t√© Nationale d'√âlectricit√© du S√©n√©gal (Senelec)",  # Senegal‚Äôs national utility that operates transmission :contentReference[oaicite:3]{index=3}
    "Soci√©t√© B√©ninoise d'√ânergie √âlectrique (SBEE)",    # Benin‚Äôs national utility (transmission included) :contentReference[oaicite:4]{index=4}
    "SONABEL (Soci√©t√© Nationale d'√âlectricit√© du Burkina Faso)",  # Burkina Faso national utility (transmission) :contentReference[oaicite:5]{index=5}
    "Electricit√© de Guin√©e (EDG)",                     # Guinea national utility (transmission by utility) :contentReference[oaicite:6]{index=6}
    "Electricidade e √Åguas da Guin√©-Bissau (EAGB)",    # Guinea‚ÄëBissau national utility (transmission) :contentReference[oaicite:7]{index=7}
    "Liberia Electricity Corporation (LEC)",            # Liberia‚Äôs national utility (transmission included) :contentReference[oaicite:8]{index=8}
    "National Water and Electricity Company (NAWEC)",   # Gambia national utility (transmission included) :contentReference[oaicite:9]{index=9}
    "CI‚ÄëENERGIES / Compagnie Ivoirienne d'√âlectricit√© (C√¥te d‚ÄôIvoire)"  # Ivory Coast utility with transmission roles :contentReference[oaicite:10]{index=10}
    "Uganda Electricity Transmission Company Limited (UETCL)",
    "Kenya Electricity Transmission Company Limited (KETRACO)",
    "Tanzania Electric Supply Company Limited (TANESCO)",  # operates transmission & distribution
    "Rwanda Energy Group Limited (REG)",
    "R√©gie de Production et Distribution d'Eau et d'√âlectricit√© (REGIDESO) Burundi",
    "Ethiopian Electric Power (EEP)",
    "Electricit√© de Djibouti (EDD)",
    "Soci√©t√© Nationale d'√âlectricit√© (SNEL) - DR Congo",
    "South Sudan Electricity Corporation (SSEC)",
    "Sudanese Electricity Transmission Company (SETCO)"
    "National Transmission Company South Africa (NTCSA)",  # Main national transmission operator :contentReference[oaicite:0]{index=0}
    "Soci√©t√© Alg√©rienne de Gestion du R√©seau de Transport de l'Electricit√© (GTRE) - Algeria",
    "Egyptian Electricity Transmission Company (EETC) - Egypt",
    "National Electric Power Company (NEPCO) - Jordan",
    "Ministry of Electricity and Water (MEW) - Kuwait",
    "Oman Electricity Transmission Company (OETC) - Oman",
    "Qatar General Electricity & Water Corporation (Kahramaa) - Qatar",
    "Saudi Electricity Company (SEC) - Saudi Arabia",
    "Dubai Electricity and Water Authority (DEWA) - UAE (transmission function)",
    "Abu Dhabi Transmission and Despatch Company (TRANSCO) - UAE",
    "Electricity and Water Authority (EWA) - Bahrain",
    "Soci√©t√© Tunisienne de l'√âlectricit√© et du Gaz (STEG) - Tunisia",
    "Office National de l'Electricit√© et de l'Eau Potable (ONEE) - Morocco",
    "Electricit√© du Liban (EDL) - Lebanon",
    "General Electricity Company of Libya (GECOL) - Libya",
    "Public Electricity Corporation - Yemen",
    "Ministry of Electricity (sector authority) - Iraq"
    "Hokkaido Electric Power Network Co., Ltd.",
    "Tohoku Electric Power Network Co., Ltd.",
    "Tokyo Electric Power Grid Co., Ltd.",
    "Chubu Electric Power Grid Co., Ltd.",
    "Hokuriku Electric Power Transmission & Distribution Co., Ltd.",
    "Kansai Electric Power Transmission & Distribution Co., Ltd.",
    "Chugoku Electric Power Network Co., Ltd.",
    "Shikoku Electric Power Transmission & Distribution Co., Ltd.",
    "Kyushu Electric Power Transmission & Distribution Co., Ltd.",
    "Okinawa Electric Power Co., Ltd.",

    # Pure transmission operators (ÈÄÅÈõª‰∫ãÊ•≠ËÄÖ)
    "J-POWER Development & Transmission Network Co., Ltd.",
    "Hokkaido North Wind Power Transmission Co., Ltd.",
    "Fukushima Transmission Co., Ltd."
    "Korea Power Exchange (KPX)",
    "Korea Electric Power Corporation (KEPCO)",
    "National Power Transmission Corporation (EVNNPT)"
    "Federal Grid Company of Unified Energy System (FGC UES)",  # main national TSO operating Russia‚Äôs high-voltage grid :contentReference[oaicite:1]{index=1}
    "System Operator of the Unified Energy System (SO UPS)",    # centralized dispatch and operational control of the Unified Power System :contentReference[oaicite:2]{index=2}
    # Note: the following are major regional or network companies that operate transmission/distribution networks
    "Rosseti",                                                # holding company for interregional/rural transmission networks :contentReference[oaicite:3]{index=3}
    "Moscow United Electric Grid Company (MOESK)",             # regional grid operator in Moscow area (transmission/distribution) :contentReference[oaicite:4]{index=4}
    "PJM Interconnection",            # RTO serving Mid‚ÄëAtlantic & Midwest regions :contentReference[oaicite:1]{index=1}
    "Midcontinent Independent System Operator (MISO)",  # RTO covering Midwest & parts of the South :contentReference[oaicite:2]{index=2}
    "California Independent System Operator (CAISO)",   # ISO for California :contentReference[oaicite:3]{index=3}
    "Southwest Power Pool (SPP)",     # RTO for central U.S. :contentReference[oaicite:4]{index=4}
    "New York Independent System Operator (NYISO)",     # ISO for New York :contentReference[oaicite:5]{index=5}
    "ISO New England (ISO‚ÄëNE)",       # RTO/ISO for New England states :contentReference[oaicite:6]{index=6}
    "Electric Reliability Council of Texas (ERCOT)",     # ISO for most of Texas :contentReference[oaicite:7]{index=7}
    "Alberta Electric System Operator (AESO)",         # Operates Alberta‚Äôs transmission system and market :contentReference[oaicite:1]{index=1}
    "AltaLink",                                       # Major transmission owner in Alberta :contentReference[oaicite:2]{index=2}
    "ATCO Electric",                                  # Transmission owner in Alberta :contentReference[oaicite:3]{index=3}
    "ENMAX (Transmission assets)",                    # Owns transmission assets in Alberta :contentReference[oaicite:4]{index=4}
    "EPCOR (Transmission assets)",                    # Owns transmission assets in Alberta :contentReference[oaicite:5]{index=5}
    "BC Hydro (Transmission)",                        # Crown corp. owns/operates BC transmission :contentReference[oaicite:6]{index=6}
    "Hydro‚ÄëQu√©bec Trans√ânergie",                      # Qu√©bec‚Äôs transmission operator :contentReference[oaicite:7]{index=7}
    "Hydro One",                                      # Ontario transmission owner :contentReference[oaicite:8]{index=8}
    "Independent Electricity System Operator (IESO)",  # Manages Ontario‚Äôs transmission system :contentReference[oaicite:9]{index=9}
    "NB Power (Transmission)",                        # New Brunswick transmission owner :contentReference[oaicite:10]{index=10}
    "SaskPower (Transmission)",                       # Saskatchewan transmission owner :contentReference[oaicite:11]{index=11}
    "Manitoba Hydro (Transmission)",                  # Manitoba‚Äôs transmission owner :contentReference[oaicite:12]{index=12}
    "Newfoundland and Labrador Hydro (Transmission)",  # NL transmission owner :contentReference[oaicite:13]{index=13}
    "Yukon Energy Corporation (Transmission)",        # Yukon transmission owner :contentReference[oaicite:14]{index=14}
    "Northwest Territories Power Corporation (Transmission)",  # NWT transmission owner :contentReference[oaicite:15]{index=15}
    "Qulliq Energy Corporation (Transmission)",        # Nunavut transmission owner (local) :contentReference[oaicite:16]{index=16}
    "National Energy System Operator (NESO)",           # Electricity system operator for Great Britain, balancing supply and demand and planning network operation. :contentReference[oaicite:0]{index=0}
    "National Grid Electricity Transmission plc",       # Electricity transmission owner for England and Wales (historical; assets now under NESO coordination). :contentReference[oaicite:1]{index=1}
    "SP Transmission plc",                              # Electricity transmission owner in central and southern Scotland. :contentReference[oaicite:2]{index=2}
    "Scottish Hydro Electric Transmission plc",         # Electricity transmission owner in northern Scotland. :contentReference[oaicite:3]{index=3}
    "SONI (System Operator for Northern Ireland)",      # Electricity transmission system operator for Northern Ireland. :contentReference[oaicite:4]{index=4}
    "NIE Networks Limited",                             # Holds electricity transmission licence in Northern Ireland. :contentReference[oaicite:5]{index=5}
    "Moyle Interconnector Limited",                     # Holds transmission licence (interconnector) in Northern Ireland. :contentReference[oaicite:6]{index=6}
    "National Gas Transmission",                         # Gas transmission operator for the UK‚Äôs National Transmission System. :contentReference[oaicite:7]{index=7}
    "EirGrid",          # Transmission System Operator for the Republic of Ireland üáÆüá™ :contentReference[oaicite:0]{index=0}
    "SONI",              # System Operator for Northern Ireland (TSO for Northern Ireland üá¨üáß) :contentReference[oaicite:1]{index=1}
    "Red El√©ctrica de Espa√±a",  # Electricity transmission system operator (TSO) in Spain :contentReference[oaicite:0]{index=0}
    "Enag√°s",                   # Natural gas transmission system operator (TSO) in Spain :contentReference[oaicite:1]{index=1}
    "Independent Power Transmission Operator S.A. (ADMIE / IPTO)",  # Electricity TSO in Greece üá¨üá∑ :contentReference[oaicite:0]{index=0}
    "Hellenic Gas Transmission System Operator S.A. (DESFA)",         # Natural gas TSO in Greece üá¨üá∑ :contentReference[oaicite:1]{index=1}
    "Turkish Electricity Transmission Corporation (TEƒ∞A≈û)",  # electricity transmission system operator in Turkey :contentReference[oaicite:0]{index=0}
    "BOTA≈û Petroleum Pipeline Corporation (BOTA≈û)",           # national natural gas transmission operator :contentReference[oaicite:1]{index=1}
    "KEGOC JSC (Kazakhstan Electricity Grid Operating Company)",  # Kazakhstan TSO :contentReference[oaicite:0]{index=0}
    "National Electric Grid of Uzbekistan JSC",  # Uzbekistan TSO :contentReference[oaicite:1]{index=1}
    "National Electric Grid of Kyrgyzstan (NESK / NEGK)",  # Kyrgyzstan TSO :contentReference[oaicite:2]{index=2}
    "Barqi Tojik",  # Tajikistan integrated electricity company (transmission included) :contentReference[oaicite:3]{index=3}
    "Turkmenenergo (Turkmenistan)",  # Turkmenistan vertically integrated utility (includes transmission) :contentReference[oaicite:4]{index=4}
    "National Power Transmission Grid (Mongolia)",  # Mongolia grid operator (transmission) :contentReference[oaicite:5]{index=5}
    "Powerlink Queensland",   # Queensland TNSP (NEM) :contentReference[oaicite:1]{index=1}
    "Transgrid",              # NSW & ACT TNSP (NEM) :contentReference[oaicite:2]{index=2}
    "ElectraNet",             # South Australia TNSP (NEM) :contentReference[oaicite:3]{index=3}
    "TasNetworks",            # Tasmania TNSP (NEM) :contentReference[oaicite:4]{index=4}
    "AusNet Services",        # Victoria TNSP (NEM) (transmission part) :contentReference[oaicite:5]{index=5}
    "Directlink",             # Interconnector TNSP (HVDC link) :contentReference[oaicite:6]{index=6}
    "Murraylink",             # Interconnector TNSP (HVDC link) :contentReference[oaicite:7]{index=7}
    "Western Power",           # WA transmission operator (SWIS) :contentReference[oaicite:8]{index=8}
    "Transpower",
    "Clarus",
    "Powerco",
    "Vector",
    "Wellington Electricity",
    "Energinet",            # Denmark :contentReference[oaicite:1]{index=1}
    "Statnett",             # Norway :contentReference[oaicite:2]{index=2}
    "Fingrid",              # Finland :contentReference[oaicite:3]{index=3}
    "Svenska kraftn√§t",     # Sweden :contentReference[oaicite:4]{index=4}
    "Elering",              # Estonia :contentReference[oaicite:5]{index=5}
    "Augstsprieguma tƒ´kls", # Latvia :contentReference[oaicite:6]{index=6}
    "Litgrid",              # Lithuania :contentReference[oaicite:7]{index=7}
    "Landsnet",             # Iceland :contentReference[oaicite:8]{index=8}
    "TenneT",               # Netherlands (for northern Europe region) :contentReference[oaicite:9]{index=9}
    "SONI",                  # Northern Ireland (UK) :contentReference[oaicite:10]{index=10}
    "Polskie Sieci Elektroenergetyczne (PSE)",                     # Poland :contentReference[oaicite:0]{index=0}
    "ƒåesk√° elektroenergetick√° p≈ôenosov√° soustava (ƒåEPS)",         # Czechia :contentReference[oaicite:1]{index=1}
    "Slovensk√° elektrizaƒçn√° prenosov√° s√∫stava (SEPS)",            # Slovakia :contentReference[oaicite:2]{index=2}
    "Magyar Villamosenergia‚Äëipari √Åtviteli Rendszerir√°ny√≠t√≥ ZRt. (MAVIR)",  # Hungary :contentReference[oaicite:3]{index=3}
    "Transelectrica",                                             # Romania :contentReference[oaicite:4]{index=4}
    "Electroenergien Sistemen Operator (ESO)",                     # Bulgaria :contentReference[oaicite:5]{index=5}
    "Ukrenergo",                                                  # Ukraine :contentReference[oaicite:6]{index=6}
    "Macedonian Transmission System Operator (MEPSO)",            # North Macedonia :contentReference[oaicite:7]{index=7}
    "Elektromre≈æa Srbije (EMS)",                                   # Serbia :contentReference[oaicite:8]{index=8}
    "Empresa Propietaria de la Red (EPR)",            # Regional transmission owner for SIEPAC :contentReference[oaicite:0]{index=0}
    "Ente Operador Regional (EOR)",                  # Regional transmission system operator for the MER/SIEPAC :contentReference[oaicite:1]{index=1}
    "Empresa de Transmisi√≥n El√©ctrica, S.A. (ETESA)", # Panama national transmission operator :contentReference[oaicite:2]{index=2}
    "Centro Nacional de Control de Energ√≠a (CENCE)",  # Costa Rica transmission system operator :contentReference[oaicite:3]{index=3}
    "Empresa Nacional de Energ√≠a El√©ctrica (ENEE)",   # Honduras vertically integrated utility & transmission operator :contentReference[oaicite:4]{index=4}
    "Instituto Nacional de Electrificaci√≥n (INDE)",   # Guatemala national transmission & electricity authority (shares in EPR) :contentReference[oaicite:5]{index=5}
    "Electric Transmission and Dispatch Center (CNDC)",# Nicaragua transmission dispatch center :contentReference[oaicite:6]{index=6}
    "Belize Electricity Limited (BEL)"                # Belize national grid operator/transmission provider :contentReference[oaicite:7]{index=7}
    "Alberta Electric System Operator (AESO) ‚Äì ISO",
    "California Independent System Operator (CAISO) ‚Äì ISO",
    "Electric Reliability Council of Texas (ERCOT) ‚Äì ISO",
    "Midcontinent Independent System Operator, Inc. (MISO) ‚Äì RTO",
    "ISO New England (ISO-NE) ‚Äì RTO",
    "New York Independent System Operator (NYISO) ‚Äì RTO [17]",
    "Ontario Independent Electricity System Operator (IESO) ‚Äì ISO",
    "PJM Interconnection (PJM) ‚Äì RTO",
    "Southwest Power Pool (SPP) ‚Äì RTO",
    "Tavanir",
    "Iran Grid Management Company (IGMC)",
    "Ministry of Energy (Iran)",
    "Latin Americans Energy Organization",
    "Electricity Generating Authority of Thailand (EGAT)",        # Transmission System Operator (TSO) and national grid operator :contentReference[oaicite:0]{index=0}
    "Metropolitan Electricity Authority (MEA)",                  # Distribution operator for Bangkok, Nonthaburi, and Samut Prakan :contentReference[oaicite:1]{index=1}
    "Provincial Electricity Authority (PEA)",                     # Distribution operator for the rest of Thailand :contentReference[oaicite:2]{index=2}
    "National Grid Corporation of the Philippines (NGCP)",       # Transmission system operator and grid operator :contentReference[oaicite:0]{index=0}
    "Independent Electricity Market Operator of the Philippines (IEMOP)",  # Market operator of the Wholesale Electricity Spot Market (WESM) :contentReference[oaicite:1]{index=1}
    "National Transmission Corporation (TransCo)",               # Government-owned entity owning transmission assets and monitoring NGCP compliance :contentReference[oaicite:2]{index=2}
    "National Power Corporation (NAPOCOR/NPC)",                  # Former grid operator (historical; still relevant in some rural electrification roles) :contentReference[oaicite:3]{index=3}
    "PT Perusahaan Listrik Negara (PLN)",       # National electricity utility operating generation, transmission, and distribution nationwide :contentReference[oaicite:1]{index=1}
    "PT PLN Batam",                             # PLN subsidiary operating the Batam electrical network :contentReference[oaicite:2]{index=2}
    "PT PLN Tarakan",                           # PLN subsidiary operating the Tarakan electrical network :contentReference[oaicite:3]{index=3}
    "Tenaga Nasional Berhad (TNB)",            # Transmission & grid operator for Peninsular Malaysia and Sabah (through SESB partnership) :contentReference[oaicite:0]{index=0}
    "Grid System Operator (GSO)",              # Real‚Äëtime grid system operator (ring‚Äëfenced entity within TNB) :contentReference[oaicite:1]{index=1}
    "Sabah Electricity Sdn. Bhd. (SESB)",       # Electricity utility (generation, transmission & distribution) in Sabah & Labuan :contentReference[oaicite:2]{index=2}
    "Sarawak Energy Berhad (SEB)",               # Electricity utility (generation, transmission & distribution) in Sarawak :contentReference[oaicite:3]{index=3}
    "Nepal Electricity Authority (NEA)",            # National utility responsible for generation, transmission, and distribution of electricity across Nepal üá≥üáµ:contentReference[oaicite:0]{index=0}
    "Rastriya Prasaran Grid Company Limited (RPGCL)", # Government‚Äëestablished transmission grid company (grid owner & system operator)üá≥üáµ:contentReference[oaicite:1]{index=1}
    "Eastern Power Distribution Company of AP Limited (APEPDCL)",
    "Northern Power Distribution Company of AP Limited (APNPDCL)",
    "Southern Power Distribution Company of AP Limited (APSPDCL)",
    "Central Power Distribution Company of AP Limited (APCPDCL)",
    "Chhattisgarh State Power Distribution Company Limited (CSPDCL)",
    "Dakshin Haryana Bijli Vitran Nigam Limited (DHBVNL)",
    "Uttar Haryana Bijli Vitran Nigam Limited (UHBVNL)",
    "Himachal Pradesh State Electricity Board Limited (HPSEBL)",
    "Jharkhand Bijli Vitran Nigam Limited (JBVNL)",
    "Madhya Pradesh Paschim Kshetra Vidyut Vitaran Company Limited (MPPKVVCL)",
    "Madhya Pradesh Poorv Kshetra Vidyut Vitaran Company Limited (MPPKVVCL)",
    "Madhya Pradesh Madhya Kshetra Vidyut Vitaran Company Limited (MPMKVVCL)",
    "Meghalaya Energy Corporation Limited (MeECL)",
    "Ajmer Vidyut Vitran Nigam Limited (AVVNL)",
    "Jaipur Vidyut Vitran Nigam Limited (JVVNL)",
    "Jodhpur Vidyut Vitran Nigam Limited (JDVVNL)",
    "Tripura State Electricity Corporation Limited (TSECL)",
    "Uttarakhand Power Corporation Limited (UPCL)",
    "Northern Power Distribution Company of Telangana Limited (TSSPDCL)",
    "Southern Power Distribution Company of Telangana Limited (TSNPDCL)",
    "Assam Power Distribution Company Limited (APDCL)",
    "North Bihar Power Distribution Company Limited (NBPDCL)",
    "South Bihar Power Distribution Company Limited (SBPDCL)",
    "Paschim Gujarat Vij Company Limited (PGVCL)",
    "Madhya Gujarat Vij Company Limited (MGVCL)",
    "Uttar Gujarat Vij Company Limited (UGVCL)",
    "Dakshin Gujarat Vij Company Limited (DGVCL)",
    "Hubli Electricity Supply Company Limited (HESCOM)",
    "Gulbarga Electricity Supply Company Limited (GESCOM)",
    "Bangalore Electricity Supply Company Limited (BESCOM)",
    "Mangalore Electricity Supply Company Limited (MESCOM)",
    "Chamundeshwari Electricity Supply Corporation Limited (CESCOM)",
    "Maharashtra State Electricity Distribution Company Limited (MSEDCL)",
    "Punjab State Power Corporation Limited (PSPCL)",
    "Tamil Nadu Generation and Distribution Corporation (TANGEDCO)",
    "Paschimanchal Vidyut Vitran Nigam Limited (PVVNL)",
    "Madhyanchal Vidyut Vitran Nigam Limited (MVVNL)",
    "Purvanchal Vidyut Vitran Nigam Limited (PUVVNL)",
    "Dakshinanchal Vidyut Vitran Nigam Limited (DVVNL)",
    "North Delhi Power Limited (NDPL)",
    "BSES Rajdhani Power Limited",
    "BSES Yamuna Power Limited",
    "New Delhi Municipal Council (NDMC)",
    "West Bengal State Electricity Distribution Company Limited (WBSEDCL)",
    "Calcutta Electric Supply Corporation Limited (CESC)",
    "North Eastern Electric Supply Company of Odisha Limited (NESCO)",
    "Central Electricity Supply Company of Odisha Limited (CESCO)",
    "Western Electricity Supply Company of Odisha Limited (WESCO)",
    "Southern Electricity Supply Company of Odisha Limited (SOUTHCO)",
    "Tata Power Delhi Distribution Limited (TPDDL)",
    "Noida Power Company Limited",
    "Kanpur Electricity Supply Company Limited (KESCO)",
    "Tata Power Company Limited",
    "Adani Electricity Mumbai Limited",
    "Torrent Power Limited",
    "Power Grid Corporation of India Limited (POWERGRID)",
    "Transmission Corporation of Andhra Pradesh Limited (APTRANSCO)",
    "Assam Electricity Grid Corporation Limited (AEGCL)",
    "Gujarat Energy Transmission Corporation Limited (GETCO)",
    "Maharashtra State Electricity Transmission Company Limited (MSETCL)",
    "Tamil Nadu Transmission Corporation Limited (TANTRANSCO)",
    "West Bengal State Electricity Transmission Company Limited (WBSETCL)",
    "Punjab State Transmission Corporation Limited (PSTCL)",
    "Haryana Vidyut Prasaran Nigam Limited (HVPNL)",
    "Rajasthan Rajya Vidyut Prasaran Nigam Limited (RVPN)",
    "Uttar Pradesh Power Transmission Corporation Limited (UPPTCL)",
    "Karnataka Power Transmission Corporation Limited (KPTCL)",
    "Telangana State Transmission Corporation Limited (TSTRANSCO)",
    "Odisha Power Transmission Corporation Limited (OPTCL)",
    "Bihar State Power Transmission Corporation Limited (BSPTCL)",
    "Chhattisgarh State Power Transmission Corporation Limited (CSPTCL)",
    "Jammu and Kashmir Power Transmission Corporation Limited (JKPTCL)",
    "Meghalaya Energy Corporation Limited (MeECL)",
    "Tripura State Electricity Corporation Limited (TSECL)",
    "Northern Region Load Despatch Centre",
    "North Eastern Region Load Despatch Centre",
    "Southern Region Load Despatch Centre",
    "Western Regional Load Despatch Centre",
    "Eastern Region Load Despatch Centre",
    "Andhra Pradesh State Load Dispatch Center",
    "Assam State Load Despatch Centre",
    "Bihar State Load Despatch Centre",
    "Chhattisgarh State Load Despatch Centre",
    "Delhi State Load Despatch Centre",
    "Gujarat State Load Despatch Centre",
    "Haryana State Load Despatch Centre",
    "Himachal Pradesh State Load Despatch Centre",
    "Jammu and Kashmir State Load Despatch Centre",
    "Jharkhand State Load Despatch Centre",
    "Karnataka State Load Despatch Centre",
    "Kerala State Load Despatch Centre",
    "Madhya Pradesh State Load Despatch Centre",
    "Maharashtra State Load Despatch Centre",
    "Meghalaya State Load Despatch Centre",
    "Mizoram State Load Despatch Centre",
    "Nagaland State Load Despatch Centre",
    "Odisha State Load Despatch Centre",
    "Punjab State Load Despatch Centre",
    "Rajasthan State Load Despatch Centre",
    "Sikkim State Load Despatch Centre",
    "Tamil Nadu State Load Despatch Centre",
    "Telangana State Load Despatch Centre",
    "Tripura State Load Despatch Centre",
    "Uttar Pradesh State Load Despatch Centre",
    "Uttarakhand State Load Despatch Centre",
    "West Bengal State Load Despatch Centre"
]

import pandas as pd
import requests
from SPARQLWrapper import SPARQLWrapper, JSON
from difflib import SequenceMatcher
import time

# ----------------------------
# Part 0: Setup
# ----------------------------
ENDPOINT_URL = "https://query.wikidata.org/sparql"
sparql = SPARQLWrapper(ENDPOINT_URL)
sparql.setReturnFormat(JSON)

# ----------------------------
# Part 1: Collect operators by types (with optional Wikipedia links)
# ----------------------------

query = """
SELECT
  ?operator ?operatorLabel
  ?operatorType ?operatorTypeLabel
  ?country ?countryLabel
  ?website
  ?hqLabel
  ?inception
  ?ceoLabel
  ?employees
  ?revenue
  ?industryLabel
  ?logo
  ?stockExchangeLabel
  ?dissolved
  ?parentOrgLabel
  ?ownedByLabel
  ?legalFormLabel
  ?linkedin
  ?twitter
  ?crunchbase
  ?bloombergTicker
  ?netProfit
  ?installedCapacity
  ?wikiArticle
WHERE {
  VALUES ?operatorType {
    wd:Q112046  # transmission system operator
    wd:Q472093  # electricity distribution network operator
    wd:Q1326624 # electricity supply company
    wd:Q200928  # electric power transmission
    wd:Q7236594 # power pool
    wd:Q137883267  # power generation company
  }

  ?operator wdt:P31 ?operatorType ;
            wdt:P17 ?country .

  OPTIONAL { ?operator wdt:P856 ?website . }
  OPTIONAL { ?operator wdt:P159 ?hq . }
  OPTIONAL { ?operator wdt:P571 ?inception . }
  OPTIONAL { ?operator wdt:P169 ?ceo . }
  OPTIONAL { ?operator wdt:P1128 ?employees . }
  OPTIONAL { ?operator wdt:P2139 ?revenue . }
  OPTIONAL { ?operator wdt:P452 ?industry . }
  OPTIONAL { ?operator wdt:P154 ?logo . }
  OPTIONAL { ?operator wdt:P414 ?stockExchange . }
  OPTIONAL { ?operator wdt:P576 ?dissolved . }

  # Additional requested properties
  OPTIONAL { ?operator wdt:P749 ?parentOrg . }
  OPTIONAL { ?operator wdt:P127 ?ownedBy . }
  OPTIONAL { ?operator wdt:P1454 ?legalForm . }
  OPTIONAL { ?operator wdt:P4264 ?linkedin . }
  OPTIONAL { ?operator wdt:P2002 ?twitter . }
  OPTIONAL { ?operator wdt:P2088 ?crunchbase . }
  OPTIONAL { ?operator wdt:P414 ?bloombergTicker . }
  OPTIONAL { ?operator wdt:P2295 ?netProfit . }
  OPTIONAL { ?operator wdt:P2109 ?installedCapacity . }

  # Optional Wikipedia link
  OPTIONAL {
    ?wikiArticle schema:about ?operator ;
                 schema:isPartOf <https://en.wikipedia.org/> .
  }

  SERVICE wikibase:label {
    bd:serviceParam wikibase:language "en".
  }
}
ORDER BY ?countryLabel ?operatorLabel
"""

sparql.setQuery(query)
results = sparql.query().convert()["results"]["bindings"]

rows = []
for r in results:
    rows.append({
        "operator_qid": r["operator"]["value"].split("/")[-1],
        "operator_label": r["operatorLabel"]["value"],
        "operator_type_qid": r.get("operatorType", {}).get("value", "").split("/")[-1] if r.get("operatorType") else None,
        "operator_type_label": r.get("operatorTypeLabel", {}).get("value"),
        "country_qid": r.get("country", {}).get("value", "").split("/")[-1] if r.get("country") else None,
        "country_label": r.get("countryLabel", {}).get("value"),
        "website": r.get("website", {}).get("value"),
        "headquarters": r.get("hqLabel", {}).get("value"),
        "inception": r.get("inception", {}).get("value"),
        "ceo": r.get("ceoLabel", {}).get("value"),
        "employees": r.get("employees", {}).get("value"),
        "revenue": r.get("revenue", {}).get("value"),
        "industry": r.get("industryLabel", {}).get("value"),
        "logo": r.get("logo", {}).get("value"),
        "stock_exchange": r.get("stockExchangeLabel", {}).get("value"),
        "dissolved": r.get("dissolved", {}).get("value"),
        "parent_organization": r.get("parentOrgLabel", {}).get("value"),
        "owned_by": r.get("ownedByLabel", {}).get("value"),
        "legal_form": r.get("legalFormLabel", {}).get("value"),
        "linkedin": r.get("linkedin", {}).get("value"),
        "twitter": r.get("twitter", {}).get("value"),
        "crunchbase": r.get("crunchbase", {}).get("value"),
        "bloomberg_ticker": r.get("bloombergTicker", {}).get("value"),
        "net_profit": r.get("netProfit", {}).get("value"),
        "installed_capacity": r.get("installedCapacity", {}).get("value"),
        "wikipedia": r.get("wikiArticle", {}).get("value")  # optional
    })

df_types = pd.DataFrame(rows)
df_types = df_types.drop_duplicates(subset="operator_qid", keep="first")
print(f"‚úÖ Retrieved {len(df_types)} unique operators by type.")

# ----------------------------
# Part 2: Collect operators by names
# ----------------------------

def similarity(a, b):
    return SequenceMatcher(None, a.lower(), b.lower()).ratio()

ALLOWED_INSTANCE_QIDS = {
    "Q4830453",  # business
    "Q783794", # company
    "Q6881511", # enterprise
    "Q891723", # public company
    "Q1951366", # public utility
    "Q197952", # corporate group
    "Q270791", # state-owned enterprise
    "Q327333", # government agency
    "Q194166", # consortium
    "Q192350", # ministry
    "Q15911314", # association
    "Q163740", #nonprofit organization
    "Q4539", # cooperative
    "Q2316331", #electric power industry
    "Q245065" # intergovernmental organization"
}

def search_wikidata(name, limit=10, fuzzy_threshold=0.6, max_fallbacks=3):
    """Search Wikidata for a name with detailed debug output."""

    def _search(query):
        print(f"\nüîç Searching for: '{query}'")
        url = "https://www.wikidata.org/w/api.php"
        params = {
            "action": "wbsearchentities",
            "search": query,
            "language": "en",
            "format": "json",
            "type": "item",
            "limit": limit
        }
        headers = {"User-Agent": "MyWikidataScript/1.0 (your_email@example.com)"}
        response = requests.get(url, params=params, headers=headers)
        try:
            data = response.json()
        except Exception as e:
            print(f"‚ùå Error decoding JSON for '{query}': {e}")
            return []

        results = []
        for item in data.get("search", []):
            qid = item["id"]
            label = item["label"]
            print(f"  Candidate found: {label} ({qid})")

            # Fetch instance of (P31) for this entity
            entity_url = f"https://www.wikidata.org/wiki/Special:EntityData/{qid}.json"
            entity_data = requests.get(entity_url, headers=headers).json()
            claims = entity_data.get("entities", {}).get(qid, {}).get("claims", {})
            instance_of_qids = {c["mainsnak"]["datavalue"]["value"]["id"] 
                                for c in claims.get("P31", []) 
                                if "datavalue" in c["mainsnak"]}

            if not instance_of_qids.intersection(ALLOWED_INSTANCE_QIDS):
                print(f"    ‚ùå Rejected: instance type {instance_of_qids} not allowed")
                continue

            score = similarity(query, label)
            print(f"    Similarity with query: {score:.2f}")
            if score >= fuzzy_threshold:
                print(f"    ‚úÖ Accepted match")
                results.append((qid, label, score))
            else:
                print(f"    ‚ùå Rejected: similarity {score:.2f} < threshold {fuzzy_threshold}")

        results.sort(key=lambda x: x[2], reverse=True)
        return results

    current_name = name
    attempts = 0
    while current_name and attempts <= max_fallbacks:
        if attempts > 0:
            print(f"\n‚ö†Ô∏è Fallback attempt {attempts}: using truncated name '{current_name}'")
        results = _search(current_name)
        if results:
            print(f"‚úÖ Matches found for '{current_name}'\n")
            return results
        # Truncate the last word for next fallback
        if " " in current_name:
            removed_word = current_name.split()[-1]
            current_name = " ".join(current_name.split()[:-1])
            print(f"  Removing last word '{removed_word}', trying '{current_name}' next...")
            attempts += 1
        else:
            break

    print(f"‚ùå No matches found for '{name}' after {attempts} fallback attempts\n")
    return []


# Example: names = ["Company A", "Company B"]
wikidata_name_results = []
for name in names:
    results = search_wikidata(name)
    if results:
        for entity_id, label, score in results:
            wikidata_name_results.append({
                "operator_name": name,
                "operator_qid": entity_id,
                "operator_label": label,
                "similarity_score": score
            })
    else:
        wikidata_name_results.append({
            "operator_name": name,
            "operator_qid": None,
            "operator_label": None,
            "similarity_score": None
        })

df_names = pd.DataFrame(wikidata_name_results)

# ----------------------------
# Part 3: Fetch missing metadata from Wikidata for new QIDs (with Wikipedia + extra fields)
# ----------------------------

def fetch_operator_metadata(qid):
    """SPARQL fetch operator info by QID, including requested extra fields"""
    if not qid:
        return None
    query = f"""
    SELECT
      ?operator ?operatorLabel
      ?operatorType ?operatorTypeLabel
      ?country ?countryLabel
      ?website
      ?hqLabel
      ?inception
      ?ceoLabel
      ?employees
      ?revenue
      ?industryLabel
      ?logo
      ?stockExchangeLabel
      ?dissolved
      ?parentOrgLabel
      ?ownedByLabel
      ?legalFormLabel
      ?linkedin
      ?twitter
      ?crunchbase
      ?bloombergTicker
      ?netProfit
      ?installedCapacity
      ?wikiArticle
    WHERE {{
      BIND(wd:{qid} AS ?operator)
      OPTIONAL {{ ?operator wdt:P31 ?operatorType. }}
      OPTIONAL {{ ?operator wdt:P17 ?country. }}
      OPTIONAL {{ ?operator wdt:P856 ?website. }}
      OPTIONAL {{ ?operator wdt:P159 ?hq. }}
      OPTIONAL {{ ?operator wdt:P571 ?inception. }}
      OPTIONAL {{ ?operator wdt:P169 ?ceo. }}
      OPTIONAL {{ ?operator wdt:P1128 ?employees. }}
      OPTIONAL {{ ?operator wdt:P2139 ?revenue. }}
      OPTIONAL {{ ?operator wdt:P452 ?industry. }}
      OPTIONAL {{ ?operator wdt:P154 ?logo. }}
      OPTIONAL {{ ?operator wdt:P414 ?stockExchange. }}
      OPTIONAL {{ ?operator wdt:P576 ?dissolved. }}
      OPTIONAL {{ ?operator wdt:P749 ?parentOrg. }}
      OPTIONAL {{ ?operator wdt:P127 ?ownedBy. }}
      OPTIONAL {{ ?operator wdt:P1454 ?legalForm. }}
      OPTIONAL {{ ?operator wdt:P4264 ?linkedin. }}
      OPTIONAL {{ ?operator wdt:P2002 ?twitter. }}
      OPTIONAL {{ ?operator wdt:P2088 ?crunchbase. }}
      OPTIONAL {{ ?operator wdt:P414 ?bloombergTicker. }}
      OPTIONAL {{ ?operator wdt:P2295 ?netProfit. }}
      OPTIONAL {{ ?operator wdt:P2109 ?installedCapacity. }}
      OPTIONAL {{
        ?wikiArticle schema:about ?operator ;
                     schema:isPartOf <https://en.wikipedia.org/> .
      }}
      SERVICE wikibase:label {{ bd:serviceParam wikibase:language "en". }}
    }}
    """
    sparql.setQuery(query)
    try:
        result = sparql.query().convert()["results"]["bindings"]
        if not result:
            return None
        r = result[0]
        return {
            "operator_qid": qid,
            "operator_label": r.get("operatorLabel", {}).get("value"),
            "operator_type_qid": r.get("operatorType", {}).get("value", "").split("/")[-1] if r.get("operatorType") else None,
            "operator_type_label": r.get("operatorTypeLabel", {}).get("value"),
            "country_qid": r.get("country", {}).get("value", "").split("/")[-1] if r.get("country") else None,
            "country_label": r.get("countryLabel", {}).get("value"),
            "website": r.get("website", {}).get("value"),
            "headquarters": r.get("hqLabel", {}).get("value"),
            "inception": r.get("inception", {}).get("value"),
            "ceo": r.get("ceoLabel", {}).get("value"),
            "employees": r.get("employees", {}).get("value"),
            "revenue": r.get("revenue", {}).get("value"),
            "industry": r.get("industryLabel", {}).get("value"),
            "logo": r.get("logo", {}).get("value"),
            "stock_exchange": r.get("stockExchangeLabel", {}).get("value"),
            "dissolved": r.get("dissolved", {}).get("value"),
            "parent_organization": r.get("parentOrgLabel", {}).get("value"),
            "owned_by": r.get("ownedByLabel", {}).get("value"),
            "legal_form": r.get("legalFormLabel", {}).get("value"),
            "linkedin": r.get("linkedin", {}).get("value"),
            "twitter": r.get("twitter", {}).get("value"),
            "crunchbase": r.get("crunchbase", {}).get("value"),
            "bloomberg_ticker": r.get("bloombergTicker", {}).get("value"),
            "net_profit": r.get("netProfit", {}).get("value"),
            "installed_capacity": r.get("installedCapacity", {}).get("value"),
            "wikipedia": r.get("wikiArticle", {}).get("value")
        }
    except Exception as e:
        print(f"Error fetching metadata for {qid}: {e}")
        return None

# Fetch metadata for new QIDs not already in df_types
new_qids = set(df_names["operator_qid"]) - set(df_types["operator_qid"])
metadata_rows = []
for qid in new_qids:
    data = fetch_operator_metadata(qid)
    if data:
        metadata_rows.append(data)
    time.sleep(0.3)  # polite delay

df_new_metadata = pd.DataFrame(metadata_rows)

# ----------------------------
# Part 4: Combine datasets
# ----------------------------

df_combined = pd.concat([df_types, df_new_metadata], ignore_index=True)

# Optional: merge similarity info from name search
df_combined = df_combined.merge(
    df_names[["operator_qid", "similarity_score", "operator_name"]],
    on="operator_qid",
    how="left"
)

df_combined = df_combined.drop_duplicates(subset="operator_qid", keep="first")

# ----------------------------
# Part 5: Save final combined CSV
# ----------------------------

df_combined.to_csv("grid_operators_combined.csv", index=False)
print(f"‚úÖ Combined dataset saved with {len(df_combined)} operators to 'grid_operators_combined.csv'.")
